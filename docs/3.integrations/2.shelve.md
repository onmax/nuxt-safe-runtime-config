---
icon: ph:vault
---

# Shelve Integration

[Shelve](https://shelve.cloud) is a secrets management platform. This integration fetches your secrets and injects them into runtime config.

## Setup

1. Install and configure Shelve CLI:

```bash
npx shelve@latest init
```

2. Enable in your config:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  safeRuntimeConfig: {
    $schema: runtimeConfigSchema,
    shelve: true, // auto-detect from shelve.json
  },
})
```

## How It Works

1. Module reads your `shelve.json` configuration
2. Fetches secrets from Shelve API at build time
3. Merges secrets into `runtimeConfig`
4. Your schema validates the merged config

Secrets from Shelve override values in `runtimeConfig`.

## Configuration

### Auto Mode (default)

```ts
safeRuntimeConfig: {
  shelve: true, // uses shelve.json settings
}
```

### Explicit Configuration

```ts
safeRuntimeConfig: {
  shelve: {
    project: 'my-project',
    slug: 'my-team',
    environment: 'production',
    url: 'https://app.shelve.cloud', // default
  },
}
```

## Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `enabled` | `boolean \| 'auto'` | `'auto'` | Enable integration |
| `project` | `string` | from shelve.json | Project name |
| `slug` | `string` | from shelve.json | Team slug |
| `environment` | `string` | auto-detected | Environment name |
| `url` | `string` | `https://app.shelve.cloud` | API URL |
| `fetchAtBuild` | `boolean` | `true` | Fetch during build |
| `fetchAtRuntime` | `boolean` | `false` | Fetch on cold start |

## Variable Transformation

Shelve variables are automatically transformed to match runtime config structure:

```
# Shelve variables
DATABASE_URL=postgres://...
NUXT_PUBLIC_API_BASE=https://api.example.com
AUTH_SECRET=my-secret

# Becomes runtimeConfig
{
  databaseUrl: 'postgres://...',
  public: {
    apiBase: 'https://api.example.com'
  },
  authSecret: 'my-secret'
}
```

Transformation rules:
- `NUXT_PUBLIC_*` becomes `public.*`
- `SCREAMING_CASE` becomes `camelCase`
- Grouped by common prefixes

## Runtime Fetch

For secrets that should be fetched fresh on each cold start:

```ts
safeRuntimeConfig: {
  shelve: {
    fetchAtBuild: false,    // skip build-time fetch
    fetchAtRuntime: true,   // fetch on server start
  },
}
```

Requires `SHELVE_TOKEN` environment variable at runtime.

## Environment Detection

Environment is auto-detected in this order:

1. `shelve.environment` option
2. `SHELVE_ENV` environment variable
3. `shelve.json` defaultEnv
4. `'development'` if `nuxt.options.dev`, else `'production'`
